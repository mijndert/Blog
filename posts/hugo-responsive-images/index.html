<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Eleventy v2.0.1">
    <title>Responsive images on a static Hugo website</title>
    <meta name="description" content="Serving optimized responsive images using Hugo" />
    <link rel="alternate" type="application/rss+xml" href="https://mijndertstuij.nl/feed.xml" />
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
    <link rel="manifest" href="favicon/site.webmanifest">
    <link rel="stylesheet" href="/css/base.css" />
    <style>@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap')</style>
  </head>
  <body>
    <header>
  <a class="muted" href="/">Mijndert Stuij</a>
</header>
    <main>
      
<h1>Responsive images on a static Hugo website</h1>
<p class="muted">2022.12.06</p>
<article><p>For years and years I've been using <a href="https://jekyllrb.com/">Jekyll</a> as my static site generator of choice, mostly because I like their templating engine and I'm a fan of Ruby as a programming language. I've been experimenting with Hugo as well, but it never really clicked for me. Well, until I found <a href="https://github.com/mavidser/hugo-rocinante">the perfect theme</a> for my needs. The same theme is now used here and on the <a href="https://blog.toot.community/">toot.community blog</a> so I wanted to set mine apart a little bit by adding banner images on some posts. Downloading an image from Unsplash and manually resizing it wasn't an option though - I need things to be frictionless when I want to add a blog entry.</p>
<p>I started looking for ways to automatically generate multiple sizes of an image and came across a lot of different solutions. Most didn't work anymore or were very convoluted. That's to say, until I found <a href="https://www.brycewray.com/posts/2022/06/responsive-optimized-images-hugo/">Bryce Wray's entry</a>.</p>
<p>I quickly adapted his code to my needs and had it working on no-time, you can see it in action <a href="/posts/scaling-mastodon-community/">right here</a>.</p>
<p>Here's how I did it.</p>
<h2>Assets directory</h2>
<p>In order to leverage the built-in image resizing capabilities of Hugo, you have to create an <code>assets/images</code> directory in the root of your project. Any other place doesn't work, unless of course you customize the directory. But I like using defaults to avoid breakage later down the line.</p>
<h2>Shortcodes</h2>
<p>The following Hugo shortcode will generate multiple sizes of a given image and spit out .webp and .jpeg files.</p>
<p>Create a file called <code>/layouts/shortcodes/imgh.html</code> in the root of your project with the following contents.</p>
<pre><code>{{- $respSizes := slice &quot;960&quot; &quot;1280&quot; &quot;1920&quot; -}}
{{- $imgBase := &quot;images/&quot; -}}
{{- $src := resources.Get (printf &quot;%s%s&quot; $imgBase (.Get &quot;src&quot;)) -}}
{{- $alt := .Get &quot;alt&quot; -}}
{{- $divClass := &quot;&quot; -}}{{/* Init'g */}}
{{- $imgClass := &quot;w-full h-auto animate-fade&quot; -}}
{{- $dataSzes := &quot;(min-width: 1024px) 100vw, 50vw&quot; -}}
{{- $actualImg := $src.Resize &quot;640x jpg&quot; -}}
&lt;picture&gt;
  &lt;source
    type=&quot;image/webp&quot;
    srcset=&quot;
      {{- with $respSizes -}}
        {{- range $i, $e := . -}}
        {{- if ge $src.Width . -}}
          {{- if $i }}, {{ end -}}{{- ($src.Resize (printf &quot;%sx%s&quot; . &quot; webp&quot;) ).RelPermalink }} {{ . }}w
        {{- end -}}
      {{- end -}}
    {{- end -}}&quot;
    sizes=&quot;{{ $dataSzes }}&quot;
  /&gt;
  &lt;source
    type=&quot;image/jpeg&quot;
    srcset=&quot;
      {{- with $respSizes -}}
        {{- range $i, $e := . -}}
          {{- if ge $src.Width . -}}
            {{- if $i }}, {{ end -}}{{- ($src.Resize (printf &quot;%sx%s&quot; . &quot; jpg&quot;) ).RelPermalink }} {{ . }}w
          {{- end -}}
      {{- end -}}
    {{- end -}}&quot;\
    sizes=&quot;{{ $dataSzes }}&quot;
  /&gt;
  &lt;img class=&quot;{{ $imgClass }}&quot;
    src=&quot;{{ $actualImg.RelPermalink }}&quot;
    width=&quot;{{ $src.Width }}&quot;
    height=&quot;{{ $src.Height }}&quot;
    alt=&quot;{{ $alt }}&quot;
    loading=&quot;lazy&quot;
  /&gt;
&lt;/picture&gt;
&lt;/div&gt;
</code></pre>
<h2>Using the shortcode</h2>
<p>Now in order to use the above shortcode you can simply drop an image into <code>/assets/images</code> and insert this line of code in your MarkDown file.</p>
<pre><code>{{&lt;/* imgh src=&quot;my-example-file.jpeg&quot; alt=&quot;My example file&quot; */&gt;}}
</code></pre>
</article>
<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none" style="top: 4px;position: relative;">
  <path fill-rule="evenodd" clip-rule="evenodd" d="M13.5706 1.07915L12.9519 0.460419L12.3332 1.07914L8.6363 4.77601L9.87373 6.01345L12.0754 3.8118C12.0758 4.19678 12.0764 4.58119 12.077 4.96525V4.9653V4.96533C12.0799 6.74156 12.0828 8.51005 12.063 10.291C11.9514 12.51 10.2821 14.5766 8.13549 15.0249L8.12156 15.0278L8.10773 15.0311C6.21947 15.49 4.06987 14.5395 3.24835 12.8164L3.24176 12.8025L3.23468 12.7889C2.46106 11.3026 2.86462 9.29521 4.17623 8.31823L4.18926 8.30852L4.20193 8.29834C5.33152 7.3898 7.12207 7.44889 8.09598 8.45611L8.10921 8.46979L8.12302 8.48289C8.65152 8.9839 8.85928 9.70255 8.85928 10.7436V10.8568H10.6093V10.7436C10.6093 9.51128 10.3691 8.21034 9.34085 7.22607C7.68339 5.5272 4.88287 5.51577 3.11789 6.92446C1.07968 8.45342 0.548175 11.4013 1.67527 13.5832C2.88159 16.0953 5.88263 17.3657 8.50709 16.735C11.4878 16.1053 13.6724 13.3174 13.8118 10.3583L13.8126 10.3426L13.8127 10.3269C13.8328 8.53249 13.8299 6.73532 13.827 4.94338V4.9431V4.94298C13.8264 4.56468 13.8258 4.18661 13.8254 3.80885L16.03 6.01344L17.2674 4.77602L13.5706 1.07915Z" fill="currentColor"></path>
</svg>
<a href="https://shareopenly.org/share/?url=https://mijndertstuij.nl/posts/hugo-responsive-images/&text=Responsive images on a static Hugo website" title="Share this post via ShareOpenly!">Share this article on social media</a>

    </main>
    <footer>
  <hr>
  <p class="muted">Receive updates</p>
  <p>Follow me via <a href="/feed.xml">RSS</a>, <a rel="me" href="https://fosstodon.org/@mijndert">Mastodon</a>, or <a href="/contact">other options</a>.</p>
</footer>
  </body>
</html>
